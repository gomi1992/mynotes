---
Category: default
Tags: 
 - 反思
 - 误删
 - 爬虫
 - python
 - selenium
 - firefox
---

# 事件说明

按照一定规则筛选待删除邮箱账号，使用 python 调用企业邮箱接口删除。发现存在误删除情况。

# 意图领会
没有理清楚领导意图，导致待删除账号范围较广，将正在使用的邮箱账号归为待删除类别。
应该及时沟通细节，不要揣测。

# 误删解决方案
## 解释方案
向用户解释时将锅甩给企业邮箱，称正在寻找解决方案，记录用户信息，解决后反馈。

## 恢复方案
在执行删除等高危操作时，应先提出恢复方案。

# 使用 python+selenium 自动点击恢复技术要点
## 连接现有 firefox
```
启动firefox
"C:\Program Files\Mozilla Firefox\firefox.exe" --marionette --marionette-port 2828

启动gecko驱动，会打印监听端口
geckodriver.exe --connect-existing --marionette-port 2828
```

```
# 创建一个新的Firefox选项对象  
options = Options()  
  
# 连接到已经存在的Firefox实例  
driver = webdriver.Remote(command_executor="http://localhost:4444", options=options)
```

## iframe 处理
需先切换到 iframe 中，才能正常执行 find_elements 等操作
```
driver.switch_to.frame('syslog_frame')
```

## 元素点击处理
在相应元素上调用 click()即可完成点击事件。

当元素不在视野内时，可能无法点击，需先滚动到元素再点。
```
driver.execute_script("arguments[0].scrollIntoView();", element)
```
